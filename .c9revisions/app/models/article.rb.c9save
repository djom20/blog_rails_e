{"ts":1347842615462,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"class Article < ActiveRecord::Base\n\textend FriendlyId\n\tfriendly_id :title, use: :slugged\n\tafter_save :store_image\n\tPHOTO_STORE = File.join Rails.root, 'public', 'photo_store'\n\tattr_accessible :title, :body,:photo, :category_list\n\tbelongs_to :user\n\thas_many :comments, dependent: :destroy\n\thas_many :categorizations\n\thas_many :categories, through: :categorizations\n\tdef category_list=(categories_string)\n\t\tself.categorizations.destroy_all\n\t\tcategory_names =categories_string.split(\",\").collect{|s| s.strip.downcase}.uniq\n\t\tcategory_names.each do |c|\n\t\t\tcategory = Category.find_or_create_by_name(c)\n\t\t\tcategori = self.categorizations.new\n\t\t\tcategori.category_id = category.id\n\t\tend\n\tend\n\tdef photo=(file_data)\n\t\tunless file_data.blank?\n\t\t\t@file_data = file_data\n\t\t\tself.extension = file_data.original_filename.split('.').last.downcase\n\t\tend\n\tend\n\tdef photo_filename\n\t\tFile.join PHOTO_STORE, \"#{id}.#{extension}\"\n\tend\n\tdef photo_path\n\t\t\"/photo_store/#{id}.#{extension}\"\n\tend\n\tdef has_photo?\n\t\tFile.exists? photo_filename\n\tend\n\t\n\tprivate\n\n\tdef store_image\n\t\tif @file_data\n\t\t\tFileUtils.mkdir_p PHOTO_STORE\n\t\t\tFile.open(photo_filename,'wb') do |f|\n\t\t\t\tf.write(@file_data.read)\n\t\t\tend\n\t\t\t@file_data = nil\n\t\tend\n\tend\n\nend\n"]],"start1":0,"start2":0,"length1":0,"length2":1215}]],"length":1215}
{"contributors":[],"silentsave":false,"ts":1347842635571,"patch":[[{"diffs":[[0,"izations"],[1,", dependent: :destroy"],[0,"\n\thas_ma"]],"start1":306,"start2":306,"length1":16,"length2":37}]],"length":1236,"saved":false}
{"ts":1347842644304,"patch":[[{"diffs":[[0,"izations"],[-1,", dependent: :destroy"],[0,"\n\thas_ma"]],"start1":306,"start2":306,"length1":37,"length2":16}]],"length":1215,"saved":false}
{"ts":1347842646190,"patch":[[{"diffs":[[0,"izations"],[1,", dependent: :destroy"],[0,"\n\tdef ca"]],"start1":355,"start2":355,"length1":16,"length2":37}]],"length":1236,"saved":false}
